<html layout:decorate="~{layout/layout.html}">
<body>
<section class="article-modify-section my-10" layout:fragment="content">
  <div class="container mx-auto">
    <form th:action method="POST" enctype="multipart/form-data" onsubmit="ModifyForm__submit(this); return false;">
      <fieldset class="fieldset">
        <legend class="fieldset-legend">제목</legend>
        <input
            class="input"
            type="text"
            placeholder="제목을 입력해주세요."
            title="input title"
            name="title"
            th:value="${article.title}"
        />
      </fieldset>
      <fieldset class="fieldset">
        <legend class="fieldset-legend">내용</legend>
        <textarea class="textarea h-24" placeholder="내용을 입력해주세요." name="content"
                  th:text="${article.content}"></textarea>
      </fieldset>
      <!-- Article Images -->
      <h2 class="text-2xl font-bold" th:if="${article.extra.genFileMap != null}">이미지 파일 수정</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mt-8">
        <th:block th:each="entry : ${article.extra.genFileMap}">
          <th:block th:with="genFile=${entry.value}, fileNo=${T(java.lang.Integer).parseInt(entry.key.split('__')[2])}">
            <div class="flex flex-col gap-y-3">
              <div class="text-[14px] flex justify-end">
                <label class="cursor-pointer">
                  <span class="badge badge-primary">이미지 삭제</span>
                  <input class="checkbox" type="checkbox" value="Y" th:name="|delete___common\_\_inBody\_\_${fileNo}|">
                </label>
              </div>
              <div class="flex flex-col gap-y-2 h-100">
                <a th:href="${genFile.url}" target="_blank" class="rounded-lg overflow-hidden">
                  <img th:src="${genFile.url}"
                       th:alt="|이미지${fileNo}|"
                       class="w-full h-full object-cover">
                </a>
                <input type="file" th:name="|common\_\_inBody\_\_${fileNo}|" class="file-input" accept="image/jpeg, image/jpg, image/png, image/gif, image/webp">
              </div>
            </div>
          </th:block>
        </th:block>
      </div>
      <div class="mt-2">
        <button type="submit" class="btn btn-neutral">수정</button>
      </div>
    </form>
  </div>
  <script>
    function ModifyForm__submit(form) {
      form.title.value = form.title.value.trim();
      if(form.title.value.length === 0) {
        alert("제목을 입력해주세요.");
        form.title.focus();
        return;
      }

      form.content.value = form.content.value.trim();
      if(form.content.value.length === 0) {
        alert("내용을 입력해주세요.");
        form.content.focus();
        return;
      }

      // 모든 유효성 검사를 통과하면 폼 제출
      form.submit();
    }
  </script>
</section>
</body>
</html>



